---
title: 'Zookeeper'
---

## Zookeeper 简介
ZooKeeper 是一个开源的分布式协调服务，它提供了一个高性能、高可用性的分布式环境下的协调服务平台。ZooKeeper 主要用于解决分布式系统中的一些共享资源管理和协调问题，其主要作用包括：
1. 分布式锁：ZooKeeper 提供了分布式锁的机制，可以确保在分布式环境下的多个进程或线程之间的互斥访问。这样可以实现对共享资源的有序访问，避免并发冲突。
2. 配置管理：ZooKeeper 可以用于集中管理分布式系统中的配置信息。应用程序可以将配置信息存储在 ZooKeeper 的节点中，并监视这些节点的变化。当配置发生变化时，应用程序可以接收到通知并及时更新自身的配置。
3. 命名服务：ZooKeeper 可以用作分布式系统中的命名服务，提供统一的命名空间。应用程序可以将自己的服务注册到 ZooKeeper 的节点上，其他应用程序可以通过查询 ZooKeeper 获取到注册的服务信息，从而实现服务发现。
4. 分布式协调：ZooKeeper 提供了一些临时节点和有序节点的特性，可以用于实现分布式系统中的选举、协调和领导者选举等功能。应用程序可以基于这些特性构建更高层次的分布式协调机制。
5. 分布式队列：ZooKeeper 提供了有序节点的特性，可以用于实现分布式环境下的队列。多个客户端可以往同一个 ZooKeeper 节点下添加有序节点，每个节点代表一个任务或消息，按照节点的顺序进行处理。

总之，ZooKeeper 在分布式系统中起着重要的作用，用于解决分布式环境下的一致性、协调和共享资源管理的问题，帮助开发人员构建可靠的分布式应用程序。

### Zookeeper 中节点
在 ZooKeeper 中，每个节点（Node）表示一个层次结构中的一个路径或目录。每个节点可以包含数据和子节点。  

ZooKeeper 是一个分布式协调服务，用于管理和协调分布式系统中的数据和进程。它提供了一个类似于文件系统的层次结构，称为 ZooKeeper 树（ZooKeeper tree）。树中的每个节点都有一个唯一的路径，类似于文件系统中的路径。  

每个节点可以存储一个小的数据块，称为节点数据（Node Data）。节点数据通常是一个字节序列，可以存储任意类型的数据。除了节点数据，节点还可以具有子节点，这样就可以构建出复杂的层次结构。  

ZooKeeper 的节点被广泛用于分布式系统中的协调任务，例如选举、配置管理、分布式锁等。每个节点在 ZooKeeper 中都有一个唯一的路径，并通过路径进行访问和操作。这种层次结构的设计使得 ZooKeeper 能够有效地管理和维护分布式系统的状态和配置信息。

### Zookeeper 常用命令
- **`help`：查看常用命令**
- **`create`：创建节点**
- **`set`：更新节点数据内容**
- **`get`：获取节点的数据**
- **`ls`：查看某个目录下的子节点**
- **`stat`：查看节点状态**
- **`ls2`：查看节点信息和状态，现已被弃用，改用 `ls -s path`**
- **`delete`：删除节点，前提是该节点必须无子节点**

### docker 运行 Zookeeper 命令
- 运行 Zookeeper：`docker run -d --name zookeeper -p 2181:2181 zookeeper:3.5.8`
- 进入 Zookeeper 容器：`docker exec -it [ContainerId] /bin/bash`
- 启动 Zookeeper：`./zkServer.sh start` 以及 `./zkServer.sh start-foreground`
- 查看 Zookeeper 状态：`./zkServer.sh status`
- 终止 Zookeeper：`./zkServer.sh stop`
- 启动默认的客户端实例：`./zkCli.sh`

注意：zkCli.sh 是 ZooKeeper 提供的命令行客户端脚本，用于连接到运行中的 ZooKeeper 服务器，并与其进行交互。执行 ./zkCli.sh 命令时，它会启动一个 ZooKeeper 客户端，并提供一个命令行界面，以便可以输入命令来执行各种操作，如创建节点、读取节点数据、监视节点等。相当于开启了一个客户端实例。

## Curator 简介
Curator是一个用于 Apache ZooKeeper 的 Java 客户端库，它简化了与 ZooKeeper 的交互和开发。Curator 提供了一组易于使用的高级 API，用于处理 ZooKeeper 的常见任务和模式，同时还提供了一些额外的功能和工具。  
Curator的主要功能和特点包括：  
1. 连接管理：Curator 提供了一套连接管理机制，可以自动处理与 ZooKeeper 服务器的连接和重连，并提供了一些选项来优化连接的性能和稳定性。
2. 客户端操作：Curator 封装了一些常见的 ZooKeeper 操作，如创建节点、删除节点、获取节点数据、设置节点数据等。这些操作通过提供简洁的 API，使开发人员能够更容易地与 ZooKeeper 进行交互。
3. 客户端状态监听：Curator 允许注册监听器来监视 ZooKeeper 客户端的状态变化，例如连接状态、会话过期等。这样，开发人员可以根据需要在状态变化时采取相应的操作。
4. 分布式锁：Curator 提供了分布式锁的实现，包括共享锁（Shared Lock）和互斥锁（Mutex Lock）。这些锁可以用于协调分布式系统中的并发访问和资源管理。
5. 分布式队列：Curator 提供了分布式队列的实现，可以在 ZooKeeper 上创建队列，并支持在队列中添加和移除元素。
6. 分布式计数器：Curator 还提供了分布式计数器的实现，允许在多个客户端之间共享计数器，并进行原子递增和递减操作。  

Curator 使得在 Java 应用程序中使用 ZooKeeper 变得更加方便和简化，提供了一些常用的模式和功能的抽象和封装。它可以帮助开发人员更高效地开发和管理基于 ZooKeeper 的分布式应用程序。


